{"version":3,"sources":["sv-wc-payment-gateway-google-pay.js"],"names":["jQuery","document","ready","$","window","SV_WC_Google_Pay_Handler_v5_8_1","params","plugin_id","merchant_id","merchant_name","gateway_id","gateway_id_dasherized","ajax_url","recalculate_totals_nonce","process_nonce","button_style","card_types","available_countries","currency_code","generic_error","gatewayID","merchantID","merchantName","ajaxURL","recalculateTotalsNonce","processNonce","buttonStyle","availableCountries","currencyCode","genericError","product_id","productID","allowedCardNetworks","baseRequest","apiVersion","apiVersionMinor","allowedCardAuthMethods","tokenizationSpecification","type","parameters","baseCardPaymentMethod","allowedAuthMethods","cardPaymentMethod","Object","assign","paymentsClient","allowedPaymentMethods","resolve","getGoogleTransactionInfo","transactionInfo","console","log","paymentDataRequest","merchantInfo","merchantId","callbackIntents","emailRequired","shippingAddressRequired","shippingAddressParameters","getGoogleShippingAddressParameters","shippingOptionRequired","google","payments","api","PaymentsClient","paymentDataCallbacks","onPaymentAuthorized","paymentData","onPaymentDataChanged","block_ui","Promise","reject","processPayment","err","error","transactionState","intent","message","reason","unblock_ui","intermediatePaymentData","shippingAddress","shippingOptionData","chosenShippingMethod","callbackTrigger","id","getUpdatedTotals","paymentDataRequestUpdate","newShippingOptionParameters","shippingOptions","length","getGoogleUnserviceableAddressError","data","action","post","response","success","parseJSON","fail_payment","shippingMethod","allowedCountryCodes","phoneNumberRequired","getGooglePaymentsClient","button","createButton","onClick","event","onGooglePaymentButtonClicked","buttonColor","getElementById","appendChild","getGooglePaymentDataRequest","totalPriceStatus","prefetchPaymentData","nonce","JSON","stringify","location","redirect","preventDefault","displayItems","loadPaymentData","init_product_page","init_cart_page","init_checkout_page","isReadyToPay","getGoogleIsReadyToPayRequest","then","result","addGooglePayButton","ui_element","parents","render_errors","errors","remove","prepend","join","removeClass","unblock","animate","scrollTop","offset","top","block","overlayCSS","background","opacity","body","trigger"],"mappings":"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","sourcesContent":["jQuery( document ).ready( ( $ ) => {\n\n\t\"use strict\"\n\n\t/**\n\t * Google Pay handler.\n\t *\n\t * @since 5.9.0-dev.1\n\t *\n\t * @type {SV_WC_Google_Pay_Handler_v5_8_1} object\n\t */\n\twindow.SV_WC_Google_Pay_Handler_v5_8_1 = class SV_WC_Google_Pay_Handler_v5_8_1 {\n\n\t\t/**\n\t\t * Handler constructor.\n\t\t *\n\t\t * @since 5.9.0-dev.1\n\t\t *\n\t\t * @param {Object} params The plugin ID\n\t\t * @param {string} params.plugin_id The plugin ID\n\t\t * @param {string} params.merchant_id The merchant ID\n\t\t * @param {string} params.merchant_name The site name\n\t\t * @param {string} params.gateway_id The gateway ID\n\t\t * @param {string} params.gateway_id_dasherized The gateway ID dasherized\n\t\t * @param {string} params.ajax_url The AJAX URL\n\t\t * @param {string} params.recalculate_totals_nonce Nonce for the recalculate_totals AJAX action\n\t\t * @param {string} params.process_nonce Nonce for the process AJAX action\n\t\t * @param {string} params.button_style The button style\n\t\t * @param {string[]} params.card_types The supported card types\n\t\t * @param {string[]} params.available_countries Array of two-letter country codes the gateway is available for\n\t\t * @param {string[]} params.currency_code WC configured currency\n\t\t * @param {string} params.generic_error The generic error message\n\t\t * @param {string} params.product_id The product ID if we are on a Product page\n\t\t */\n\t\tconstructor(params) {\n\n\t\t\tlet {\n\t\t\t\tplugin_id,\n\t\t\t\tmerchant_id,\n\t\t\t\tmerchant_name,\n\t\t\t\tgateway_id,\n\t\t\t\tgateway_id_dasherized,\n\t\t\t\tajax_url,\n\t\t\t\trecalculate_totals_nonce,\n\t\t\t\tprocess_nonce,\n\t\t\t\tbutton_style,\n\t\t\t\tcard_types,\n\t\t\t\tavailable_countries,\n\t\t\t\tcurrency_code,\n\t\t\t\tgeneric_error\n\t\t\t} = params;\n\n\t\t\tthis.gatewayID = gateway_id;\n\t\t\tthis.merchantID = merchant_id;\n\t\t\tthis.merchantName = merchant_name;\n\t\t\tthis.ajaxURL = ajax_url;\n\t\t\tthis.recalculateTotalsNonce = recalculate_totals_nonce;\n\t\t\tthis.processNonce = process_nonce;\n\t\t\tthis.buttonStyle = button_style;\n\t\t\tthis.availableCountries = available_countries;\n\t\t\tthis.currencyCode = currency_code;\n\t\t\tthis.genericError = generic_error;\n\n\t\t\tif (params.product_id) {\n\t\t\t\tthis.productID = params.product_id;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Card networks supported by your site and your gateway\n\t\t\t *\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n\t\t\t */\n\t\t\tconst allowedCardNetworks = card_types;\n\n\t\t\t/**\n\t\t\t * Define the version of the Google Pay API referenced when creating your configuration\n\t\t\t *\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#PaymentDataRequest|apiVersion in PaymentDataRequest}\n\t\t\t */\n\t\t\tthis.baseRequest = {\n\t\t\t\tapiVersion: 2,\n\t\t\t\tapiVersionMinor: 0\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Card authentication methods supported by your site and your gateway\n\t\t\t *\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n\t\t\t *\n\t\t\t * @todo confirm your processor supports Android device tokens for your supported card networks\n\t\t\t */\n\t\t\tconst allowedCardAuthMethods = [\"PAN_ONLY\", \"CRYPTOGRAM_3DS\"];\n\n\t\t\t/**\n\t\t\t * Identify your gateway and your site's gateway merchant identifier\n\t\t\t *\n\t\t\t * The Google Pay API response will return an encrypted payment method capable\n\t\t\t * of being charged by a supported gateway after payer authorization\n\t\t\t *\n\t\t\t * @todo check with your gateway on the parameters to pass\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#gateway|PaymentMethodTokenizationSpecification}\n\t\t\t */\n\t\t\tconst tokenizationSpecification = {\n\t\t\t\ttype: 'PAYMENT_GATEWAY',\n\t\t\t\tparameters: {\n\t\t\t\t\t'gateway': plugin_id,\n\t\t\t\t\t'gatewayMerchantId': this.merchantID\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Describe your site's support for the CARD payment method and its required fields\n\t\t\t *\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n\t\t\t */\n\t\t\tthis.baseCardPaymentMethod = {\n\t\t\t\ttype: 'CARD',\n\t\t\t\tparameters: {\n\t\t\t\t\tallowedAuthMethods: allowedCardAuthMethods,\n\t\t\t\t\tallowedCardNetworks: allowedCardNetworks\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Describe your site's support for the CARD payment method including optional fields\n\t\t\t *\n\t\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n\t\t\t */\n\t\t\tthis.cardPaymentMethod = Object.assign(\n\t\t\t\t{},\n\t\t\t\tthis.baseCardPaymentMethod,\n\t\t\t\t{\n\t\t\t\t\ttokenizationSpecification: tokenizationSpecification\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * An initialized google.payments.api.PaymentsClient object or null if not yet set\n\t\t\t *\n\t\t\t * @see {@link getGooglePaymentsClient}\n\t\t\t */\n\t\t\tthis.paymentsClient = null;\n\t\t}\n\n\t\t/**\n\t\t * Configure your site's support for payment methods supported by the Google Pay\n\t\t * API.\n\t\t *\n\t\t * Each member of allowedPaymentMethods should contain only the required fields,\n\t\t * allowing reuse of this base request when determining a viewer's ability\n\t\t * to pay and later requesting a supported payment method\n\t\t *\n\t\t * @returns {object} Google Pay API version, payment methods supported by the site\n\t\t */\n\t\tgetGoogleIsReadyToPayRequest() {\n\n\t\t\treturn Object.assign(\n\t\t\t\t{},\n\t\t\t\tthis.baseRequest,\n\t\t\t\t{\n\t\t\t\t\tallowedPaymentMethods: [this.baseCardPaymentMethod]\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t/**\n\t\t * Configure support for the Google Pay API\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#PaymentDataRequest|PaymentDataRequest}\n\t\t *\n\t\t * @param {function} resolve callback\n\t\t * @returns {object} PaymentDataRequest fields\n\t\t */\n\t\tgetGooglePaymentDataRequest( resolve ) {\n\n\t\t\treturn this.getGoogleTransactionInfo( ( transactionInfo ) => {\n\n\t\t\t\tconsole.log( 'transactionInfo' );\n\t\t\t\tconsole.log( transactionInfo );\n\n\t\t\t\tconst paymentDataRequest = Object.assign({}, this.baseRequest);\n\t\t\t\tpaymentDataRequest.allowedPaymentMethods = [this.cardPaymentMethod];\n\n\t\t\t\tpaymentDataRequest.transactionInfo = transactionInfo;\n\n\t\t\t\tconsole.log(paymentDataRequest);\n\n\t\t\t\tpaymentDataRequest.merchantInfo = {\n\t\t\t\t\tmerchantId: this.merchantID,\n\t\t\t\t\tmerchantName: this.merchantName\n\t\t\t\t};\n\n\t\t\t\tpaymentDataRequest.callbackIntents = [\"SHIPPING_ADDRESS\", \"SHIPPING_OPTION\", \"PAYMENT_AUTHORIZATION\"];\n\t\t\t\tpaymentDataRequest.emailRequired = true;\n\t\t\t\tpaymentDataRequest.shippingAddressRequired = true;\n\t\t\t\tpaymentDataRequest.shippingAddressParameters = this.getGoogleShippingAddressParameters();\n\t\t\t\tpaymentDataRequest.shippingOptionRequired = true;\n\n\t\t\t\tresolve( paymentDataRequest );\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Return an active PaymentsClient or initialize\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/client#PaymentsClient|PaymentsClient constructor}\n\t\t * @returns {google.payments.api.PaymentsClient} Google Pay API client\n\t\t */\n\t\tgetGooglePaymentsClient() {\n\t\t\tif ( this.paymentsClient === null ) {\n\t\t\t\tthis.paymentsClient = new google.payments.api.PaymentsClient({\n\t\t\t\t\tmerchantInfo: {\n\t\t\t\t\t\tmerchantName: this.merchantName,\n\t\t\t\t\t\tmerchantId: this.merchantID\n\t\t\t\t\t},\n\t\t\t\t\tpaymentDataCallbacks: {\n\t\t\t\t\t\tonPaymentAuthorized: (paymentData) => this.onPaymentAuthorized(paymentData),\n\t\t\t\t\t\tonPaymentDataChanged: (paymentData) => this.onPaymentDataChanged(paymentData)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this.paymentsClient;\n\t\t}\n\n\t\tonPaymentAuthorized(paymentData) {\n\n\t\t\tthis.block_ui();\n\t\t\tconsole.log('onPaymentAuthorized');\n\t\t\tconsole.log(paymentData);\n\n\t\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t\t// handle the response\n\t\t\t\ttry {\n\t\t\t\t\tthis.processPayment(paymentData, resolve);\n\t\t\t\t\t\t// .then(() => {\n\t\t\t\t\t\t// \tresolve({transactionState: 'SUCCESS'});\n\t\t\t\t\t\t// })\n\t\t\t\t\t\t// .catch(() => {\n\t\t\t\t\t\t// \tconsole.log('catch');\n\t\t\t\t\t\t// \tresolve({\n\t\t\t\t\t\t// \t\ttransactionState: 'ERROR',\n\t\t\t\t\t\t// \t\terror: {\n\t\t\t\t\t\t// \t\t\tintent: 'SHIPPING_ADDRESS',\n\t\t\t\t\t\t// \t\t\tmessage: 'Invalid data',\n\t\t\t\t\t\t// \t\t\treason: 'PAYMENT_DATA_INVALID'\n\t\t\t\t\t\t// \t\t}\n\t\t\t\t\t\t// \t});\n\t\t\t\t\t\t// });\n\t\t\t\t}\tcatch(err) {\n\t\t\t\t\tconsole.log('catch');\n\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\treject({\n\t\t\t\t\t\ttransactionState: 'ERROR',\n\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\tintent: 'PAYMENT_AUTHORIZATION',\n\t\t\t\t\t\t\tmessage: 'Insufficient funds',\n\t\t\t\t\t\t\treason: 'PAYMENT_DATA_INVALID'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.unblock_ui();\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Handles dynamic buy flow shipping address and shipping options callback intents.\n\t\t *\n\t\t * @param {object} intermediatePaymentData response from Google Pay API a shipping address or shipping option is selected in the payment sheet.\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#IntermediatePaymentData|IntermediatePaymentData object reference}\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentDataRequestUpdate|PaymentDataRequestUpdate}\n\t\t * @returns Promise<{object}> Promise of PaymentDataRequestUpdate object to update the payment sheet.\n\t\t */\n\t\tonPaymentDataChanged(intermediatePaymentData) {\n\n\t\t\tthis.block_ui();\n\n\t\t\tconsole.log('onPaymentDataChanged');\n\t\t\tconsole.log(intermediatePaymentData);\n\n\t\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t\tconsole.log(resolve);\n\t\t\t\tconsole.log(reject);\n\n\t\t\t\ttry {\n\t\t\t\t\tlet shippingAddress = intermediatePaymentData.shippingAddress;\n\t\t\t\t\tlet shippingOptionData = intermediatePaymentData.shippingOptionData;\n\t\t\t\t\tlet chosenShippingMethod = '';\n\n\t\t\t\t\tif (intermediatePaymentData.callbackTrigger == \"SHIPPING_OPTION\") {\n\t\t\t\t\t\tchosenShippingMethod = shippingOptionData.id;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.getUpdatedTotals( shippingAddress, chosenShippingMethod, ( paymentDataRequestUpdate ) => {\n\n\t\t\t\t\t\tif (paymentDataRequestUpdate.newShippingOptionParameters.shippingOptions.length == 0) {\n\t\t\t\t\t\t\tpaymentDataRequestUpdate = {\n\t\t\t\t\t\t\t\terror: this.getGoogleUnserviceableAddressError()\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.log('paymentDataRequestUpdate');\n\t\t\t\t\t\tconsole.log(paymentDataRequestUpdate);\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresolve(paymentDataRequestUpdate);\n\t\t\t\t\t\t}\tcatch(err) {\n\t\t\t\t\t\t\tconsole.log('catch on resolve');\n\t\t\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\tcatch(err) {\n\t\t\t\t\tconsole.log('catch');\n\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\treject({\n\t\t\t\t\t\ttransactionState: 'ERROR',\n\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\tintent: 'PAYMENT_AUTHORIZATION',\n\t\t\t\t\t\t\tmessage: 'Insufficient funds',\n\t\t\t\t\t\t\treason: 'PAYMENT_DATA_INVALID'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.unblock_ui();\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Provide Google Pay API with a payment amount, currency, and amount status\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#TransactionInfo|TransactionInfo}\n\t\t *\n\t\t * @param {function} resolve callback\n\t\t * @returns {object} transaction info, suitable for use as transactionInfo property of PaymentDataRequest\n\t\t */\n\t\tgetGoogleTransactionInfo( resolve ) {\n\n\t\t\t// get transaction info from cart\n\t\t\tconst data = {\n\t\t\t\taction: `wc_${this.gatewayID}_google_pay_get_transaction_info`,\n\t\t\t}\n\n\t\t\tif (this.productID) {\n\t\t\t\tdata.productID = this.productID;\n\t\t\t}\n\n\t\t\t$.post(this.ajaxURL, data, ( response ) => {\n\n\t\t\t\tconsole.log(response);\n\n\t\t\t\tif (response.success) {\n\t\t\t\t\tresolve( $.parseJSON( response.data ) )\n\t\t\t\t} else {\n\t\t\t\t\tthis.fail_payment( 'Could not build transaction info. ' + response.data.message );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Get updated totals and shipping options via AJAX for use in the PaymentDataRequest\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentDataRequestUpdate|PaymentDataRequestUpdate}\n\t\t *\n\t\t * @param {object} shippingAddress shipping address\n\t\t * @param {object} shippingMethod chosen shipping method\n\t\t * @param {function} resolve callback\n\t\t */\n\t\tgetUpdatedTotals( shippingAddress, shippingMethod, resolve ) {\n\n\t\t\tconst data = {\n\t\t\t\taction: `wc_${this.gatewayID}_google_pay_recalculate_totals`,\n\t\t\t\t'nonce': this.recalculateTotalsNonce,\n\t\t\t\tshippingAddress,\n\t\t\t\tshippingMethod\n\t\t\t}\n\n\t\t\tif (this.productID) {\n\t\t\t\tdata.productID = this.productID;\n\t\t\t}\n\n\t\t\t$.post(this.ajaxURL, data, ( response ) => {\n\n\t\t\t\tconsole.log(response);\n\n\t\t\t\tif (response.success) {\n\t\t\t\t\tresolve( $.parseJSON( response.data ) )\n\t\t\t\t} else {\n\t\t\t\t\tthis.fail_payment( 'Could not recalculate totals. ' + response.data.message );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Provide Google Pay API with shipping address parameters when using dynamic buy flow.\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#ShippingAddressParameters|ShippingAddressParameters}\n\t\t * @returns {object} shipping address details, suitable for use as shippingAddressParameters property of PaymentDataRequest\n\t\t */\n\t\tgetGoogleShippingAddressParameters() {\n\n\t\t\treturn  {\n\t\t\t\tallowedCountryCodes: this.availableCountries,\n\t\t\t\tphoneNumberRequired: true\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Provide Google Pay API with a payment data error.\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentDataError|PaymentDataError}\n\t\t * @returns {object} payment data error, suitable for use as error property of PaymentDataRequestUpdate\n\t\t */\n\t\tgetGoogleUnserviceableAddressError() {\n\t\t\treturn {\n\t\t\t\treason: \"SHIPPING_ADDRESS_UNSERVICEABLE\",\n\t\t\t\tmessage: \"Cannot ship to the selected address\",\n\t\t\t\tintent: \"SHIPPING_ADDRESS\"\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Add a Google Pay purchase button alongside an existing checkout button\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#ButtonOptions|Button options}\n\t\t * @see {@link https://developers.google.com/pay/api/web/guides/brand-guidelines|Google Pay brand guidelines}\n\t\t */\n\t\taddGooglePayButton() {\n\n\t\t\tconst paymentsClient = this.getGooglePaymentsClient();\n\t\t\tconst button = paymentsClient.createButton({\n\t\t\t\tonClick: (event) => this.onGooglePaymentButtonClicked( event ),\n\t\t\t\tbuttonColor: this.buttonStyle\n\t\t\t});\n\t\t\tdocument.getElementById('sv-wc-google-pay-button-container').appendChild(button);\n\t\t}\n\n\t\t/**\n\t\t * Prefetch payment data to improve performance\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/client#prefetchPaymentData|prefetchPaymentData()}\n\t\t */\n\t\tprefetchGooglePaymentData() {\n\n\t\t\tthis.getGooglePaymentDataRequest( ( paymentDataRequest ) => {\n\n\t\t\t\t// transactionInfo must be set but does not affect cache\n\t\t\t\tpaymentDataRequest.transactionInfo = {\n\t\t\t\t\ttotalPriceStatus: 'NOT_CURRENTLY_KNOWN',\n\t\t\t\t\tcurrencyCode: this.currencyCode\n\t\t\t\t};\n\t\t\t\tconst paymentsClient = this.getGooglePaymentsClient();\n\t\t\t\tpaymentsClient.prefetchPaymentData(paymentDataRequest);\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Process payment data returned by the Google Pay API\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentData|PaymentData object reference}\n\t\t *\n\t\t * @param {object} paymentData response from Google Pay API after user approves payment\n\t\t * @param {function} resolve callback\n\t\t */\n\t\tprocessPayment(paymentData, resolve) {\n\n\t\t\t// show returned data in developer console for debugging\n\t\t\tconsole.log(paymentData);\n\n\t\t\t// pass payment token to your gateway to process payment\n\t\t\tconst data = {\n\t\t\t\taction: `wc_${this.gatewayID}_google_pay_process_payment`,\n\t\t\t\tnonce: this.processNonce,\n\t\t\t\tpaymentData: JSON.stringify(paymentData)\n\t\t\t}\n\n\t\t\treturn $.post(this.ajaxURL, data, (response) => {\n\t\t\t\tif (response.success) {\n\t\t\t\t\tresolve({transactionState: 'SUCCESS'});\n\t\t\t\t\twindow.location = response.data.redirect;\n\t\t\t\t} else {\n\t\t\t\t\tresolve({\n\t\t\t\t\t\ttransactionState: 'ERROR',\n\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\tintent: 'SHIPPING_ADDRESS',\n\t\t\t\t\t\t\tmessage: 'Invalid data',\n\t\t\t\t\t\t\treason: 'PAYMENT_DATA_INVALID'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.fail_payment( 'Payment could no be processed. ' + response.data.message );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Show Google Pay payment sheet when Google Pay payment button is clicked\n\t\t */\n\t\tonGooglePaymentButtonClicked(event) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.block_ui();\n\n\t\t\tthis.getGooglePaymentDataRequest( ( paymentDataRequest ) => {\n\n\t\t\t\tconsole.log(paymentDataRequest);\n\t\t\t\tconsole.log(paymentDataRequest.transactionInfo);\n\t\t\t\tconsole.log(paymentDataRequest.transactionInfo.displayItems);\n\t\t\t\tconst paymentsClient = this.getGooglePaymentsClient();\n\t\t\t\ttry {\n\t\t\t\t\tpaymentsClient.loadPaymentData(paymentDataRequest);\n\t\t\t\t} catch (err) {\n\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\tconsole.log('catch');\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t}\n\n\t\t\t\tthis.unblock_ui();\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Initialize Google PaymentsClient after Google-hosted JavaScript has loaded\n\t\t *\n\t\t * Display a Google Pay payment button after confirmation of the viewer's\n\t\t * ability to pay.\n\t\t */\n\t\tinit() {\n\n\t\t\t// initialize for the various pages\n\t\t\tif ($('form.cart').length) {\n\t\t\t\tthis.init_product_page();\n\t\t\t} else if ($('form.woocommerce-cart-form').length) {\n\t\t\t\tthis.init_cart_page();\n\t\t\t} else if ($('form.woocommerce-checkout').length) {\n\t\t\t\tthis.init_checkout_page()\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst paymentsClient = this.getGooglePaymentsClient();\n\t\t\tpaymentsClient.isReadyToPay(this.getGoogleIsReadyToPayRequest())\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (response.result) {\n\t\t\t\t\t\tthis.addGooglePayButton();\n\t\t\t\t\t\t// @todo prefetch payment data to improve performance after confirming site functionality\n\t\t\t\t\t\t// this.prefetchGooglePaymentData();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Initializes the product page.\n\t\t */\n\t\tinit_product_page() {\n\t\t\tthis.ui_element = $('form.cart');\n\t\t}\n\n\t\t/**\n\t\t * Initializes the cart page.\n\t\t */\n\t\tinit_cart_page() {\n\t\t\tthis.ui_element = $('form.woocommerce-cart-form').parents('div.woocommerce');\n\t\t}\n\n\t\t/**\n\t\t * Initializes the checkout page.\n\t\t */\n\t\tinit_checkout_page() {\n\t\t\tthis.ui_element = $('form.woocommerce-checkout');\n\t\t}\n\n\t\t/**\n\t\t * Fails the purchase based on the gateway result.\n\t\t */\n\t\tfail_payment ( error ) {\n\n\t\t\tconsole.error( '[Google Pay] ' + error );\n\n\t\t\tthis.unblock_ui();\n\n\t\t\tthis.render_errors( [ this.genericError ] );\n\t\t}\n\n\t\t/**\n\t\t * Renders any new errors and bring them into the viewport.\n \t\t */\n\t\trender_errors( errors ) {\n\n\t\t\t// hide and remove any previous errors\n\t\t\t$('.woocommerce-error, .woocommerce-message').remove();\n\n\t\t\t// add errors\n\t\t\tthis.ui_element.prepend('<ul class=\"woocommerce-error\"><li>' + errors.join('</li><li>') + '</li></ul>');\n\n\t\t\t// unblock UI\n\t\t\tthis.ui_element.removeClass('processing').unblock();\n\n\t\t\t// scroll to top\n\t\t\t$('html, body').animate({scrollTop: this.ui_element.offset().top - 100}, 1000);\n\t\t}\n\n\t\t/**\n\t\t * Blocks the payment form UI.\n\t\t */\n\t\tblock_ui() {\n\t\t\tthis.ui_element.block({message: null, overlayCSS: {background: '#fff', opacity: 0.6}});\n\t\t}\n\n\t\t/**\n\t\t * Unblocks the payment form UI.\n\t\t */\n\t\tunblock_ui() {\n\t\t\tthis.ui_element.unblock();\n\t\t}\n\t}\n\n\t$( document.body ).trigger( 'sv_wc_google_pay_handler_v5_8_1_loaded' );\n\n} );\n"],"file":"sv-wc-payment-gateway-google-pay.min.js"}